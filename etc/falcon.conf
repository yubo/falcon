pidFile "./var/falcon.pid";
root "${GOPATH}/src/github.com/yubo/falcon";
log stdout 3;

include ./etc/ctrl.conf;
//include ./etc/transfer.conf;

backend N1 {
	debug;
	rpc             on;
	http            off;
	rpcAddr         0.0.0.0:7020;
	httpAddr        0.0.0.0:7021;
	ctrlAddr        127.0.0.1:8001;
	dsn             ${FALCON_DSN};
	dbMaxIdle       4;
	connTimeout     1000;              // 连接超时时间, 千分之一秒(ms)
	callTimeout     5000;              // 请求超时时间
	workerProcesses 2;                 // 数据迁移时连接目标服务器的并发数量
	hdisk "./var/data/hd01";
	migrate {
		disabled;
		upstream {
			storage_00 127.0.0.1:7020;
			storage_01 127.0.0.1:7021;
		};
	};
}

loadbalance N1 {
	debug;
	rpc             on;
	http            on;
	rpcAddr         0.0.0.0:7010;
	httpAddr        0.0.0.0:7011;
	workerProcesses 2;                 // upstream 的并发连接数
	payloadSize     16;                // meta number per rpc call package
	connTimeout     1000;              // 连接超时时间, 千分之一秒(ms)
	callTimeout     5000;              // 请求超时时间
	backend {                          // 后端服务类型，支持tsdb、falcon
		tsdb t1 {                  // 类型名称 实例名称
			disabled;
			upstream {
				tsdb_00  127.0.0.1:6090;
				tsdb_01  127.0.0.1:6091;
			};
		};
		falcon "storage" {
			#disabled
			upstream {
				storage_00 127.0.0.1:7020;
				#storage_01 127.0.0.1:7021;
			};
		};
	};
}

agent "agent" {
	debug;
	host            localhost;
	http            on;
	interval        5;
	httpAddr        0.0.0.0:7000;
	ifacePrefix     eth,em;
	workerProcesses 3;
	connTimeout     1000;
	callTimeout     5000;
	upstream        127.0.0.1:1234,127.0.0.1:1235;
	emuEnable       true;
	emuHost         emu_host_%2d;
	emuHostNum      10;
	emuMetric       emu_metric_%2d;
	emuMetricNum    10;
	emuTpl          ./var/tpl/emu_tpl_%2d;          
	emuTplNum       5;  
}
